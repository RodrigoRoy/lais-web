<!-- Página con el formulario para agregar un evento -->

<div class="container">
    <!--Script para mostrar mensajes de error en los campos del formulario-->
    <script type="text/ng-template" id="error-messages">
        <span ng-message="required" class="help-block">Este campo es obligatorio.</span>
        <span ng-message="maxlength" class="help-block">La información excede el límite de longitud permitido.</span>
        <span ng-message="minlength" class="help-block">La información es demasiado corta.</span>
        <span ng-message="date" class="help-block">La fecha es incorrecta.</span>
        <span ng-message="url" class="help-block">Se requiere la dirección completa de internet (comúnmente iniciando con "http://").</span>
        <span ng-message="pattern" class="help-block">El formato de este campo es incorrecto.</span>
    </script>

    <h1>Agregar nuevo evento</h1>

    <!-- Formulario para agregar un nuevo evento a la base de datos -->
    <form name="eventoForm" id="eventoForm" role="form" novalidate>
        <!-- TITULO DEL EVENTO -->
        <div class="form-group" ng-class="{'has-error': eventoForm.titulo.$dirty && eventoForm.titulo.$invalid}">
            <label class="control-label" for="titulo">Título</label>
            <input class="form-control" type="text" name="titulo" id="titulo" ng-model="evento.titulo" ng-maxlength="150" ng-trim required>
            <div ng-messages="eventoForm.titulo.$error" ng-show="eventoForm.titulo.$dirty && eventoForm.titulo.$invalid"><div ng-messages-include="error-messages"></div></div>
        </div>

        <!-- DESCRIPCION DEL EVENTO -->
        <div class="form-group" ng-class="{'has-error': eventoForm.descripcion.$dirty && eventoForm.descripcion.$invalid}">
            <label class="control-label" for="descripcion">Descripción</label>
            <textarea class="form-control" rows="2" name="descripcion" id="descripcion" placeholder="Breve descripción del evento" ng-model="evento.descripcion" ng-maxlength="250" ng-trim></textarea>
            <div ng-messages="eventoForm.descripcion.$error" ng-show="eventoForm.descripcion.$dirty && eventoForm.descripcion.$invalid"><div ng-messages-include="error-messages"></div></div>
        </div>

        <!-- INFORMACIÓN COMPLETA DEL EVENTO (HTML) -->
        <div class="form-group" ng-class="{'has-error': eventoForm.contenidoHTML.$dirty && eventoForm.contenidoHTML.$invalid}">
          <label class="control-label" for="contenidoHTML">Contenido</label>
          <div text-angular ng-model="evento.contenidoHTML" ta-text-editor-class="form-control" ta-html-editor-class="form-control" id="contenidoHTML" placeholder="Información completa sobre el evento" required></div>
          <div ng-messages="eventoForm.contenidoHTML.$error" ng-show="eventoForm.contenidoHTML.$dirty && eventoForm.contenidoHTML.$invalid"><div ng-messages-include="error-messages"></div></div>
        </div>

        <!-- FECHA -->
        <div class="form-group">
            <label class="control-label" for="fecha">Fecha</label>
            <div class="input-group">
                <input type="text" id="fecha" class="form-control" uib-datepicker-popup ng-model="evento.fecha" is-open="showDate" close-text="Listo" current-text="Hoy" clear-text="Borrar">
                <span class="input-group-btn">
                    <button type="button" class="btn btn-default" ng-click="openDate()"><i class="glyphicon glyphicon-calendar"></i></button>
                </span>
            </div>
        </div>

        <!-- HORARIO -->
        <div class="form-group">
            <label class="control-label" for="horario">Horario</label>
            <uib-timepicker id="horario" ng-model="evento.horario" hour-step="1" minute-step="1"></uib-timepicker>
        </div>

        <!-- TIPO DE EVENTO -->
        <div class="form-group" ng-class="{'has-error': eventoForm.tipo.$dirty && eventoForm.tipo.$invalid}">
            <label class="control-label" for="tipo">Tipo de evento</label>
            <select class="form-control" id="tipo" ng-model="evento.tipo">
                <option value="academico">Académico</option>
                <option value="docencia">Docencia</option>
            </select>
            <div ng-messages="eventoForm.tipo.$error" ng-show="eventoForm.tipo.$dirty && eventoForm.tipo.$invalid"><div ng-messages-include="error-messages"></div></div>
        </div>

        <!-- REALIZADOR -->
        <div class="form-group">
            <label class="control-label" for="realizador">Realizador(es)</label>
            <input type="text" class="form-control" ng-repeat="realizador in realizadores" ng-model="realizador.nombre">
            <button class="btn btn-default" ng-click="add()" ng-disabled="realizadores[realizadores.length-1].nombre === ''" ng-show="realizadores.length < maxLengthRealizadores"><i class="fa fa-user-plus"></i></button>
        </div>

        <!-- IMAGEN -->
        <div class="form-group">
            <label class="control-label" for="imagenPrincipal">Imagen</label>
            <!-- Detalles del componente: https://github.com/danialfarid/ng-file-upload -->
            <div ngf-select ngf-drop ng-model="imagenPrincipal" name="imagenPrincipal" id="imagenPrincipal" ngf-capture="'camera'" ngf-accept="'image/*'" ngf-pattern="'image/*'" style="border: 5px dashed #F5F5F5; width: 170px; text-align: center; padding: 50px 10px;"><i class="fa fa-file-image-o"></i> Selecciona o arrastra imagen</div>
            <!--Previsualización de imagen-->
            <img ngf-src="imagenPrincipal" ngf-resize="{height: 120, quality: 0.9}">
        </div>

        <!-- LUGAR -->
        <div class="form-group">
            <label class="control-label" for="lugar">Dirección</label>
            <input type="text" id="lugar" ng-model="asyncLugar" placeholder="Nombre del lugar" uib-typeahead="lugar as lugar.nombre for lugar in searchPlace($viewValue)" typeahead-loading="loadingLocations" typeahead-no-results="noResults" typeahead-editable="false" typeahead-on-select="onSelect($item, $model, $label)" class="form-control" autocomplete="off">
            <i ng-show="loadingLocations" class="glyphicon glyphicon-refresh"></i>
            <div ng-show="noResults">
                <i class="glyphicon glyphicon-remove"></i> No se encontraron resultados
            </div>
            <button class="btn btn-default" type="button" ng-show="!showDirection && !asyncLugar" ng-click="openLugarForm()">Agregar dirección</button>
        </div>

        <!-- NOTAS -->
        <div class="form-group" ng-class="{'has-error': eventoForm.notas.$dirty && eventoForm.notas.$invalid}">
            <label class="control-label" for="notas">Notas</label>
            <textarea class="form-control" rows="3" name="notas" id="notas" placeholder="Información adicional acerca del evento" ng-model="evento.notas" ng-trim></textarea>
            <div ng-messages="eventoForm.notas.$error" ng-show="eventoForm.notas.$dirty && eventoForm.notas.$invalid"><div ng-messages-include="error-messages"></div></div>
        </div>
        
        <button type="submit" class="btn btn-primary" ng-disabled="eventoForm.$invalid" ng-click="enviar()">Agregar evento</button>
    </form>

    <!-- DIRECCIÓN (Lugar) -->
    <form name="lugarForm" id="lugarForm" role="form" novalidate class="form-inline" ng-show="showDirection">
        <h3>Dirección</h3>

        <!-- Nombre -->
        <div class="form-group" ng-class="{'has-error': lugarForm.nombre.$dirty && lugarForm.nombre.$invalid}">
            <label class="control-label" for="nombre">Nombre del lugar</label>
            <input class="form-control" type="text" name="nombre" id="nombre" ng-model="lugar.nombre" ng-maxlength="150" ng-trim required>
            <div ng-messages="lugarForm.nombre.$error" ng-show="lugarForm.nombre.$dirty && lugarForm.nombre.$invalid"><div ng-messages-include="error-messages"></div></div>
        </div>

        <!-- Calle -->
        <div class="form-group" ng-class="{'has-error': lugarForm.calle.$dirty && lugarForm.calle.$invalid}">
            <label class="control-label" for="calle">Calle</label>
            <input class="form-control" type="text" name="calle" id="calle" ng-model="lugar.direccion.calle">
            <div ng-messages="lugarForm.calle.$error" ng-show="lugarForm.calle.$dirty && lugarForm.calle.$invalid"><div ng-messages-include="error-messages"></div></div>
        </div>

        <!-- Número -->
        <div class="form-group" ng-class="{'has-error': lugarForm.numero.$dirty && lugarForm.numero.$invalid}">
            <label class="control-label" for="numero">Número</label>
            <input class="form-control" type="text" name="numero" id="numero" ng-model="lugar.direccion.numero">
            <div ng-messages="lugarForm.numero.$error" ng-show="lugarForm.numero.$dirty && lugarForm.numero.$invalid"><div ng-messages-include="error-messages"></div></div>
        </div>

        <!-- Número interior -->
        <div class="form-group" ng-class="{'has-error': lugarForm.numeroInterior.$dirty && lugarForm.numeroInterior.$invalid}">
            <label class="control-label" for="numeroInterior">Número interior</label>
            <input class="form-control" type="text" name="numeroInterior" id="numeroInterior" ng-model="lugar.direccion.numeroInterior">
            <div ng-messages="lugarForm.numeroInterior.$error" ng-show="lugarForm.numeroInterior.$dirty && lugarForm.numeroInterior.$invalid"><div ng-messages-include="error-messages"></div></div>
        </div>

        <!-- Colonia -->
        <div class="form-group" ng-class="{'has-error': lugarForm.colonia.$dirty && lugarForm.colonia.$invalid}">
            <label class="control-label" for="colonia">Colonia</label>
            <input class="form-control" type="text" name="colonia" id="colonia" ng-model="lugar.direccion.colonia">
            <div ng-messages="lugarForm.colonia.$error" ng-show="lugarForm.colonia.$dirty && lugarForm.colonia.$invalid"><div ng-messages-include="error-messages"></div></div>
        </div>

        <!-- Ciudad -->
        <div class="form-group" ng-class="{'has-error': lugarForm.ciudad.$dirty && lugarForm.ciudad.$invalid}">
            <label class="control-label" for="ciudad">Ciudad</label>
            <input class="form-control" type="text" name="ciudad" id="ciudad" ng-model="lugar.direccion.ciudad">
            <div ng-messages="lugarForm.ciudad.$error" ng-show="lugarForm.ciudad.$dirty && lugarForm.ciudad.$invalid"><div ng-messages-include="error-messages"></div></div>
        </div>

        <!-- Estado -->
        <div class="form-group" ng-class="{'has-error': lugarForm.estado.$dirty && lugarForm.estado.$invalid}">
            <label class="control-label" for="estado">Estado</label>
            <input class="form-control" type="text" name="estado" id="estado" ng-model="lugar.direccion.estado">
            <div ng-messages="lugarForm.estado.$error" ng-show="lugarForm.estado.$dirty && lugarForm.estado.$invalid"><div ng-messages-include="error-messages"></div></div>
        </div>

        <!-- Código postal -->
        <div class="form-group" ng-class="{'has-error': lugarForm.cp.$dirty && lugarForm.cp.$invalid}">
            <label class="control-label" for="cp">Código postal</label>
            <input class="form-control" type="text" name="cp" id="cp" ng-model="lugar.direccion.cp">
            <div ng-messages="lugarForm.cp.$error" ng-show="lugarForm.cp.$dirty && lugarForm.cp.$invalid"><div ng-messages-include="error-messages"></div></div>
        </div>

        <!-- País -->
        <div class="form-group" ng-class="{'has-error': lugarForm.pais.$dirty && lugarForm.pais.$invalid}">
            <label class="control-label" for="pais">País</label>
            <input class="form-control" type="text" name="pais" id="pais" ng-model="lugar.direccion.pais" placeholder="México">
            <div ng-messages="lugarForm.pais.$error" ng-show="lugarForm.pais.$dirty && lugarForm.pais.$invalid"><div ng-messages-include="error-messages"></div></div>
        </div>

        <!-- Teléfono(s) -->
        <div class="form-group">
            <label class="control-label" for="telefono">Teléfono(s)</label>
            <input type="text" class="form-control" ng-repeat="telefono in telefonos" ng-model="telefono.numero">
            <button class="btn btn-default" ng-click="addPhone()" ng-disabled="telefonos[telefonos.length-1].numero === ''" ng-show="telefonos.length < maxLengthTelefonos"><i class="fa fa-plus"></i></i></button>
        </div>

        <!-- Contacto -->
        <div class="form-group" ng-class="{'has-error': lugarForm.contacto.$dirty && lugarForm.contacto.$invalid}">
            <label class="control-label" for="contacto">Contacto</label>
            <input class="form-control" type="text" name="contacto" id="contacto" ng-model="lugar.contacto" placeholder="Persona y/o email">
            <div ng-messages="lugarForm.contacto.$error" ng-show="lugarForm.contacto.$dirty && lugarForm.contacto.$invalid"><div ng-messages-include="error-messages"></div></div>
        </div>

        <button type="submit" class="btn btn-primary" ng-disabled="lugarForm.$invalid" ng-click="addPlace()">Agregar lugar</button>
    </form>


</div>